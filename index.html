<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>萌寵當家 AI GO PET SALON | 頂級寵物護理</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@300;400;500;700;900&family=Cormorant+Garamond:wght@400;600&display=swap" rel="stylesheet">

    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/signature_pad@4.1.7/dist/signature_pad.umd.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>

    <script>
        tailwind.config = { 
            theme: {
                extend: {
                    colors: {
                        theme: {
                            bg: '#FAF8F5',       // 更乾淨的米白底
                            rose: '#D88E99',     // 莫蘭迪玫瑰粉
                            roseDeep: '#B56576', // 深玫瑰
                            gold: '#C5A065',     // 香檳金
                            goldLight: '#E5CFA0',// 淺金
                            text: '#4A4238',     // 深褐灰
                            sub: '#8C857B',      // 輔助灰
                        }
                    },
                    fontFamily: {
                        serif: ['"Noto Serif TC"', 'serif'],
                        en: ['"Cormorant Garamond"', 'serif'],
                    },
                    boxShadow: {
                        'glass': '0 8px 32px 0 rgba(74, 66, 56, 0.08)',
                        'glass-hover': '0 20px 40px -5px rgba(216, 142, 153, 0.25)',
                        'glow': '0 0 20px rgba(216, 142, 153, 0.4)',
                        'inner-light': 'inset 0 1px 1px rgba(255, 255, 255, 0.8)',
                    },
                    backgroundImage: {
                        'gradient-lux': 'linear-gradient(135deg, #D88E99 0%, #C5A065 100%)',
                        'shimmer': 'linear-gradient(45deg, rgba(255,255,255,0) 40%, rgba(255,255,255,0.4) 50%, rgba(255,255,255,0) 60%)',
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.8s ease-out forwards',
                        'slide-up': 'slideUp 0.8s cubic-bezier(0.2, 0.8, 0.2, 1) forwards',
                        'float': 'float 4s ease-in-out infinite',
                        'shimmer': 'shimmer 2.5s infinite',
                    },
                    keyframes: {
                        fadeIn: { from: { opacity: '0' }, to: { opacity: '1' } },
                        slideUp: { from: { opacity: '0', transform: 'translateY(40px)' }, to: { opacity: '1', transform: 'translateY(0)' } },
                        float: { '0%, 100%': { transform: 'translateY(0)' }, '50%': { transform: 'translateY(-8px)' } },
                        shimmer: { '0%': { backgroundPosition: '-200% center' }, '100%': { backgroundPosition: '200% center' } }
                    }
                }
            }
        }
    </script>

    <style>
        body { 
            background-color: #FAF8F5;
            background-image: 
                radial-gradient(circle at 10% 20%, rgba(216, 142, 153, 0.08) 0%, transparent 40%),
                radial-gradient(circle at 90% 80%, rgba(197, 160, 101, 0.08) 0%, transparent 40%);
            font-family: 'Noto Serif TC', serif;
            color: #4A4238;
            -webkit-tap-highlight-color: transparent;
            overflow-x: hidden;
        }

        .glass-panel { 
            background: rgba(255, 255, 255, 0.75); 
            backdrop-filter: blur(20px) saturate(140%); 
            -webkit-backdrop-filter: blur(20px) saturate(140%);
            border: 1px solid rgba(255, 255, 255, 0.6); 
            box-shadow: var(--tw-shadow-glass), var(--tw-shadow-inner-light);
        }

        .btn-card {
            background: rgba(255, 255, 255, 0.6);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.5);
            transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
        }
        .btn-card:hover {
            background: rgba(255, 255, 255, 0.9);
            transform: translateY(-4px);
            border-color: #D88E99;
            box-shadow: var(--tw-shadow-glass-hover);
        }
        .btn-card:active { transform: scale(0.98); }

        .input-minimal {
            width: 100%;
            background: transparent;
            border-bottom: 1px solid #Ccc;
            padding: 0.8rem 0.5rem;
            font-size: 16px;
            color: #4A4238;
            transition: all 0.3s;
            border-radius: 4px 4px 0 0;
        }
        .input-minimal:focus {
            border-color: #D88E99;
            background: rgba(216, 142, 153, 0.05);
        }
        .input-minimal::placeholder { color: #BBB; font-size: 0.9em; }

        .custom-scrollbar::-webkit-scrollbar { width: 4px; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #E5CFA0; border-radius: 10px; }
        
        .text-gradient {
            background: linear-gradient(135deg, #4A4238 30%, #B56576 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .text-gold-gradient {
            background: linear-gradient(to right, #B88746, #E5CFA0, #B88746);
            background-size: 200% auto;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: shimmer 5s linear infinite;
        }

        .safe-pb { padding-bottom: max(20px, env(safe-area-inset-bottom)); }
        
        .checkbox-custom {
            appearance: none;
            background-color: #fff;
            margin: 0;
            font: inherit;
            color: currentColor;
            width: 1.25em;
            height: 1.25em;
            border: 1px solid #D88E99;
            border-radius: 0.25em;
            display: grid;
            place-content: center;
            transition: 0.2s;
        }
        .checkbox-custom::before {
            content: "";
            width: 0.65em;
            height: 0.65em;
            transform: scale(0);
            transition: 0.12s transform ease-in-out;
            box-shadow: inset 1em 1em #D88E99;
            transform-origin: center;
            clip-path: polygon(14% 44%, 0 65%, 50% 100%, 100% 16%, 80% 0%, 43% 62%);
        }
        .checkbox-custom:checked::before { transform: scale(1); }
    </style>
</head>

<body class="min-h-screen relative flex flex-col">

    <nav class="fixed top-0 w-full z-50 transition-all duration-500 opacity-0 pointer-events-none" id="navbar">
        <div class="bg-white/70 backdrop-blur-xl border-b border-white/40 shadow-sm">
            <div class="px-6 py-4 flex justify-between items-center max-w-lg mx-auto">
                <div class="flex items-center gap-3" onclick="router('home')">
                    <div class="w-9 h-9 rounded-full bg-theme-bg border border-theme-rose/20 flex items-center justify-center overflow-hidden shadow-inner">
                         <img src="logo.png" class="w-full h-full object-cover" onerror="this.style.display='none'; this.nextElementSibling.style.display='block'">
                         <i data-lucide="dog" class="hidden w-5 h-5 text-theme-rose"></i>
                    </div>
                    <span class="font-bold text-lg tracking-widest text-theme-text font-serif">萌寵當家</span>
                </div>
                <button onclick="router('home')" class="flex items-center gap-1.5 text-xs font-bold text-theme-sub hover:text-theme-rose transition-colors tracking-[0.15em] uppercase border border-transparent hover:border-theme-rose/20 px-3 py-1.5 rounded-full">
                    <i data-lucide="arrow-left" class="w-3.5 h-3.5"></i> Back
                </button>
            </div>
        </div>
    </nav>

    <main class="flex-1 w-full max-w-lg mx-auto relative z-10 flex flex-col py-6 px-6">

        <div id="view-home" class="flex flex-col justify-center min-h-[90vh] py-8">
            
            <div class="w-full glass-panel rounded-[32px] p-10 text-center relative overflow-hidden animate-slide-up z-20 mb-8 group">
                <div class="absolute -top-24 -right-24 w-64 h-64 bg-theme-rose/10 rounded-full blur-3xl"></div>
                <div class="absolute -bottom-24 -left-24 w-64 h-64 bg-theme-gold/10 rounded-full blur-3xl"></div>

                <div class="relative z-10 mb-8 flex justify-center">
                    <div class="w-44 h-44 rounded-full p-2 bg-gradient-to-br from-white/80 to-white/20 shadow-xl border border-white flex items-center justify-center animate-float ring-1 ring-white/50">
                        <div class="w-full h-full rounded-full overflow-hidden bg-white flex items-center justify-center relative">
                            <img src="logo.png" alt="Logo" class="w-full h-full object-cover transform transition duration-700 group-hover:scale-110" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex'">
                            <div class="hidden flex-col items-center justify-center gap-2 text-theme-rose/30">
                                <i data-lucide="bone" class="w-12 h-12"></i>
                                <span class="text-xs tracking-widest font-bold">IMAGE</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="relative z-10 space-y-3 mb-10">
                    <h1 class="text-3xl font-black tracking-[0.25em] leading-tight text-gradient font-serif">
                        萌寵當家
                    </h1>
                    <div class="h-px w-24 bg-gradient-to-r from-transparent via-theme-rose/50 to-transparent mx-auto"></div>
                    <span class="font-en text-xl font-semibold text-gold-gradient tracking-[0.15em] block">
                        AI GO PET SALON
                    </span>
                    <p class="text-xs text-theme-sub tracking-[0.3em] font-medium pt-2">
                        <span>極致呵護・專業洗護</span>
                    </p>
                </div>

                
                <div class="relative z-10">
                    <button onclick="router('form')" class="group relative w-full overflow-hidden rounded-xl shadow-lg hover:shadow-glow transition-all duration-500 transform hover:-translate-y-1">
                        <div class="absolute inset-0 bg-gradient-lux opacity-90 group-hover:opacity-100 transition"></div>
                        <div class="absolute inset-0 bg-shimmer bg-[length:200%_100%] animate-shimmer opacity-30"></div>
                        <div class="relative py-4 px-6 flex items-center justify-center gap-3">
                            <i data-lucide="feather" class="w-5 h-5 text-white"></i>
                            <span class="text-white font-bold text-lg tracking-[0.2em] font-serif">填寫寵物美容契約</span>
                            <i data-lucide="chevron-right" class="w-4 h-4 text-white/70 group-hover:translate-x-1 transition-transform"></i>
                        </div>
                    </button>
                    <p class="text-[10px] text-theme-sub mt-3 tracking-wider opacity-70">
                        * test
                    </p>
                </div>
            </div>

            <div class="w-full space-y-3 animate-slide-up" style="animation-delay: 0.15s; opacity: 0; animation-fill-mode: forwards;">
                
                <a href="https://line.me/R/ti/p/@567xvlnf" target="_blank" class="btn-card flex items-center p-4 rounded-2xl group hover:border-[#06C755]/50">
                    <div class="w-10 h-10 rounded-full bg-[#06C755]/10 text-[#06C755] flex items-center justify-center mr-4 group-hover:bg-[#06C755] group-hover:text-white transition-colors duration-300">
<svg viewBox="0 0 256 256" class="w-5 h-5" fill="currentColor">
    <g transform="translate(1.4 1.4) scale(2.81)">
        <path d="M 42.685 88.018 c -0.944 0 -1.935 -0.233 -2.809 -0.929 c -2.075 -1.653 -1.61 -4.302 -1.435 -5.299 l 0.015 -0.085 c 0.097 -0.573 0.523 -3.138 0.589 -3.532 c 0.143 -1.106 0.122 -1.725 0.087 -2.032 c -0.248 -0.131 -0.736 -0.332 -1.527 -0.51 C 15.806 72.699 0 57.334 0 39.057 C 0 18.615 20.187 1.984 45 1.984 c 24.813 0 45 16.631 45 37.073 c 0 6.388 -1.921 12.34 -5.848 18.055 h 0.347 l -2.727 3.14 c -0.471 0.568 -0.964 1.135 -1.476 1.7 l -0.03 0.034 c -9.005 10.364 -29.164 23.109 -34.124 25.199 C 45.535 87.442 44.169 88.018 42.685 88.018 z M 45 7.872 c -21.566 0 -39.112 13.99 -39.112 31.185 c 0 15.321 13.716 28.255 32.614 30.754 l 0.234 0.04 c 3.099 0.668 5.056 1.964 5.817 3.853 c 0.524 1.311 0.625 2.988 0.324 5.285 l -0.015 0.099 c 0 0 -0.221 1.327 -0.399 2.397 c 5.106 -2.446 21.464 -12.945 29.972 -21.843 l 1.432 -1.571 c 5.626 -6.17 8.246 -12.212 8.246 -19.015 C 84.112 21.862 66.566 7.872 45 7.872 z"/>
        <path d="M 37.309 31.467 h -2.655 c -0.407 0 -0.737 0.33 -0.737 0.736 v 16.492 c 0 0.406 0.33 0.735 0.737 0.735 h 2.655 c 0.407 0 0.737 -0.329 0.737 -0.735 V 32.203 C 38.047 31.797 37.716 31.467 37.309 31.467"/>
        <path d="M 55.584 31.467 h -2.655 c -0.407 0 -0.737 0.33 -0.737 0.736 v 9.798 l -7.558 -10.207 c -0.017 -0.026 -0.037 -0.051 -0.057 -0.075 h -2.655 c -0.407 0 -0.737 0.33 -0.737 0.736 v 16.492 c 0 0.406 0.33 0.735 0.737 0.735 h 2.655 v -10.59 l 7.567 10.22 c 0.052 0.073 0.117 0.134 0.187 0.182 h 2.655 c 0.407 0 0.737 -0.329 0.737 -0.735 V 32.203 C 56.321 31.797 55.991 31.467 55.584 31.467"/>
        <path d="M 30.91 45.302 h -7.214 V 32.204 c 0 -0.407 -0.33 -0.737 -0.737 -0.737 h -2.655 c -0.407 0 -0.737 0.33 -0.737 0.737 v 16.491 c 0 0.407 0.33 0.737 0.737 0.737 H 30.91 c 0.407 0 0.736 -0.33 0.736 -0.737 v -2.655 C 31.646 45.632 31.316 45.302 30.91 45.302"/>
        <path d="M 70.245 35.597 c 0.407 0 0.736 -0.33 0.736 -0.737 v -2.655 c 0 -0.407 -0.329 -0.738 -0.736 -0.738 H 59.639 v 16.489 c 0 0.407 0.33 0.737 0.737 0.737 h 10.606 c 0.407 0 0.736 -0.33 0.736 -0.737 v -2.655 c 0 -0.407 -0.329 -0.737 -0.736 -0.737 h -7.213 v -2.788 h 7.213 c 0.407 0 0.736 -0.33 0.736 -0.737 v -2.655 c 0 -0.407 -0.329 -0.738 -0.736 -0.738 h -7.213 v -2.787 H 70.245 z"/>
    </g>
</svg>                    </div>
                    <div class="flex-1">
                         <span class="block text-[10px] font-bold text-theme-sub tracking-widest uppercase mb-0.5">Online Booking</span>
                         <span class="block text-sm font-bold text-theme-text group-hover:text-[#06C755] transition-colors">加入 LINE 官方帳號</span>
                    </div>
                    <i data-lucide="chevron-right" class="w-4 h-4 text-gray-300 group-hover:text-[#06C755]"></i>
                </a>

                <a href="https://www.facebook.com/0616AIGO/?locale=zh_TW" target="_blank" class="btn-card flex items-center p-4 rounded-2xl group">
                     <div class="w-10 h-10 rounded-full bg-[#1877F2]/10 text-[#1877F2] flex items-center justify-center mr-4 group-hover:bg-[#1877F2] group-hover:text-white transition-colors duration-300">
                        <i data-lucide="facebook" class="w-5 h-5"></i>
                    </div>
                    <div class="flex-1">
                         <span class="block text-[10px] font-bold text-theme-sub tracking-widest uppercase mb-0.5">Social Media</span>
                         <span class="block text-sm font-bold text-theme-text group-hover:text-[#1877F2] transition-colors">追蹤 Facebook 粉絲專頁</span>
                    </div>
                    <i data-lucide="arrow-up-right" class="w-4 h-4 text-gray-300 group-hover:text-[#1877F2]"></i>
                </a>

                <a href="https://maps.google.com/?q=新北市蘆洲區長安街285巷30號" target="_blank" class="btn-card flex items-center p-4 rounded-2xl group">
                     <div class="w-10 h-10 rounded-full bg-gray-100 text-gray-500 flex items-center justify-center mr-4 group-hover:bg-theme-gold group-hover:text-white transition-colors">
                        <i data-lucide="map-pin" class="w-5 h-5"></i>
                    </div>
                    <div class="flex-1">
                         <span class="block text-[10px] font-bold text-theme-sub tracking-widest uppercase mb-0.5">Location</span>
                         <span class="block text-sm font-bold text-theme-text group-hover:text-theme-gold transition-colors">新北市蘆洲區長安街285巷30號</span>
                    </div>
                    <i data-lucide="arrow-up-right" class="w-4 h-4 text-gray-300 group-hover:text-theme-gold"></i>
                </a>

                <div class="grid grid-cols-2 gap-3">
                    <a href="tel:0277515677" class="btn-card p-4 flex flex-col items-center justify-center gap-3 rounded-2xl group">
                        <div class="w-10 h-10 rounded-full bg-theme-rose/10 text-theme-rose flex items-center justify-center group-hover:bg-theme-rose group-hover:text-white transition-colors duration-300">
                            <i data-lucide="phone-call" class="w-5 h-5"></i>
                        </div>
                        <div class="text-center">
                            <span class="block text-[10px] font-bold text-theme-sub tracking-widest uppercase mb-1">Reservation</span>
                            <span class="block text-sm font-bold text-theme-text font-en tracking-wider">02 7751 5677</span>
                        </div>
                    </a>

                    <div class="btn-card p-4 flex flex-col items-center justify-center gap-3 rounded-2xl cursor-default">
                        <div class="w-10 h-10 rounded-full bg-theme-gold/10 text-theme-gold flex items-center justify-center">
                            <i data-lucide="clock-3" class="w-5 h-5"></i>
                        </div>
                        <div class="text-center">
                            <span class="block text-[10px] font-bold text-theme-sub tracking-widest uppercase mb-1">Opening</span>
                            <span class="block text-sm font-bold text-theme-text font-en tracking-wider">10:00 – 19:00</span>
                            <span class="block text-[10px] text-theme-rose font-medium mt-0.5">(週一公休)</span>
                        </div>
                    </div>
                </div>

            </div>
        </div>

        <div id="view-form" class="hidden pb-20 pt-20 safe-pb animate-fade-in">
            
            <header class="text-center mb-10 space-y-2">
                <span class="text-xs font-bold text-theme-gold tracking-[0.3em] uppercase block mb-2 font-en">Service Agreement</span>
                <h2 class="text-2xl font-black text-theme-text tracking-[0.2em] font-serif">寵物美容契約書</h2>
                <div class="flex items-center justify-center gap-2 text-theme-sub/60 mt-3">
                    <span class="h-px w-8 bg-theme-sub/30"></span>
                    <i data-lucide="paw-print" class="w-3 h-3"></i>
                    <span class="h-px w-8 bg-theme-sub/30"></span>
                </div>
            </header>

            <form id="petForm" class="space-y-6" onsubmit="event.preventDefault();">
                
                <section class="glass-panel p-6 rounded-3xl relative overflow-hidden">
                    <div class="absolute top-0 left-0 w-1 h-full bg-theme-rose"></div>
                    <h3 class="flex items-center gap-2 text-theme-text font-bold text-sm tracking-widest mb-6">
                        <i data-lucide="user-circle" class="w-5 h-5 text-theme-rose"></i> 飼主資料
                    </h3>
                    <div class="space-y-5">
                        <div class="group">
                            <label class="block text-[10px] font-bold text-theme-sub uppercase tracking-wider mb-1">Full Name</label>
                            <input type="text" placeholder="您的姓名" class="input-minimal">
                        </div>
                        <div class="group">
                            <label class="block text-[10px] font-bold text-theme-sub uppercase tracking-wider mb-1">Phone Number</label>
                            <input type="tel" placeholder="聯絡電話" maxlength="10" class="input-minimal">
                        </div>
                        <div class="group">
                             <label class="block text-[10px] font-bold text-theme-sub uppercase tracking-wider mb-1">Address</label>
                            <input type="text" placeholder="居住地址" class="input-minimal">
                        </div>
                    </div>
                </section>

                <section class="glass-panel p-6 rounded-3xl relative overflow-hidden">
                     <div class="absolute top-0 left-0 w-1 h-full bg-theme-gold"></div>
                    <h3 class="flex items-center gap-2 text-theme-text font-bold text-sm tracking-widest mb-6">
                        <i data-lucide="dog" class="w-5 h-5 text-theme-gold"></i> 毛孩資料
                    </h3>
                    <div class="grid grid-cols-2 gap-5">
                        <div class="col-span-2">
                             <label class="block text-[10px] font-bold text-theme-sub uppercase tracking-wider mb-1">Pet Name</label>
                            <input type="text" placeholder="毛孩名字" class="input-minimal">
                        </div>
                        <div>
                             <label class="block text-[10px] font-bold text-theme-sub uppercase tracking-wider mb-1">Breed</label>
                            <input type="text" placeholder="品種 (例: 貴賓)" class="input-minimal">
                        </div>
                        <div>
                             <label class="block text-[10px] font-bold text-theme-sub uppercase tracking-wider mb-1">Gender</label>
                            <div class="flex gap-2 mt-2">
                                <label class="flex-1 cursor-pointer">
                                    <input type="radio" name="sex" class="peer hidden" value="male">
                                    <div class="py-2 text-center border border-gray-200 rounded-lg peer-checked:bg-[#E8F0FE] peer-checked:text-[#1967D2] peer-checked:border-[#1967D2] transition text-sm font-bold text-gray-400">男生</div>
                                </label>
                                <label class="flex-1 cursor-pointer">
                                    <input type="radio" name="sex" class="peer hidden" value="female">
                                    <div class="py-2 text-center border border-gray-200 rounded-lg peer-checked:bg-[#FCE8E6] peer-checked:text-[#C5221F] peer-checked:border-[#C5221F] transition text-sm font-bold text-gray-400">女生</div>
                                </label>
                            </div>
                        </div>
                        <div class="col-span-2">
                             <label class="block text-[10px] font-bold text-theme-sub uppercase tracking-wider mb-1">Health Condition</label>
                            <textarea rows="2" placeholder="備註：過敏、舊傷、疾病史..." class="input-minimal resize-none bg-white/30 rounded-lg border border-gray-200 focus:border-theme-rose focus:ring-0 p-3"></textarea>
                        </div>
                    </div>
                </section>

                <section class="glass-panel p-0 rounded-3xl overflow-hidden">
                    <div class="p-4 bg-white/50 border-b border-white/60">
                         <h3 class="text-theme-text font-bold text-sm tracking-widest text-center">服務條款確認</h3>
                    </div>
                    <div class="p-5 max-h-40 overflow-y-auto text-xs text-justify leading-relaxed text-theme-sub custom-scrollbar space-y-2.5 bg-white/20">
                         <p>1. <strong class="text-theme-text">告知義務：</strong>若寵物有攻擊性、特殊疾病、年老或極度緊張，請務必事先告知。</p>
                        <p>2. <strong class="text-theme-text">除蟲約定：</strong>美容過程中若發現寄生蟲，將強制進行除蟲藥浴，費用另計。</p>
                        <p>3. <strong class="text-theme-text">緊急醫療：</strong>若發生不可抗力意外，本店將立即送醫，費用由飼主負擔。</p>
                        <p>4. <strong class="text-theme-text">逾時費用：</strong>請於約定時間接回寵物，逾時將收取安親費用。</p>
                        <p class="text-theme-rose font-bold mt-2">5. 本人確認已完全理解並同意上述內容。</p>
                    </div>
                    <div class="p-4 bg-theme-rose/5 border-t border-theme-rose/10 flex justify-center">
                        <label class="flex items-center gap-3 cursor-pointer select-none">
                            <input type="checkbox" id="agreeCheck" class="checkbox-custom">
                            <span class="text-xs font-bold text-theme-text tracking-wide">我同意服務條款</span>
                        </label>
                    </div>
                </section>

                <section class="glass-panel p-6 rounded-3xl">
                    <label class="block text-xs font-bold text-theme-sub mb-3 tracking-[0.2em] uppercase text-center font-en">Signature</label>
                    <div onclick="openSignatureModal()" class="w-full h-36 border border-theme-sub/20 rounded-2xl bg-white/40 shadow-inner flex items-center justify-center cursor-pointer hover:border-theme-rose/50 transition-all relative overflow-hidden group">
                        <div id="sign-placeholder" class="text-center group-hover:scale-105 transition duration-500">
                             <div class="w-12 h-12 bg-white rounded-full flex items-center justify-center mx-auto mb-3 shadow-sm text-theme-rose/60 border border-white">
                                <i data-lucide="pen-tool" class="w-5 h-5"></i>
                            </div>
                            <span class="text-xs font-bold text-theme-sub/50 tracking-widest">點擊簽名</span>
                        </div>
                        <img id="sign-preview" class="hidden absolute inset-0 w-full h-full object-contain p-4" />
                        <div class="absolute bottom-2 right-2 opacity-20">
                            <i data-lucide="feather" class="w-16 h-16 text-theme-text rotate-[-15deg]"></i>
                        </div>
                    </div>
                </section>

                <button onclick="submitForm(this)" class="w-full bg-gradient-lux text-white py-4 rounded-2xl font-bold shadow-lg shadow-theme-rose/30 active:scale-[0.98] transition-all flex items-center justify-center gap-3 tracking-[0.2em] text-lg mt-4 group overflow-hidden relative">
                    <div class="absolute inset-0 bg-white/20 translate-y-full group-hover:translate-y-0 transition-transform duration-300"></div>
                    <span class="relative z-10">確認送出契約</span>
                    <i data-lucide="send" class="w-5 h-5 relative z-10 group-hover:translate-x-1 transition-transform"></i>
                </button>
                
                <div class="h-6"></div>
            </form>
        </div>
    </main>

    <div id="signatureModal" class="fixed inset-0 z-[9999] hidden bg-theme-text/40 backdrop-blur-[2px] items-end sm:items-center justify-center opacity-0 transition-opacity duration-300">
        <div class="bg-[#FAF8F5] w-full sm:w-[90%] sm:max-w-md rounded-t-[32px] sm:rounded-[32px] p-6 flex flex-col shadow-2xl h-[80vh] sm:h-auto transform translate-y-full transition-transform duration-500 cubic-bezier(0.32, 0.72, 0, 1)" id="modalContent">
            
            <div class="flex justify-between items-center mb-6">
                <button onclick="closeSignatureModal()" class="w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center text-gray-500 hover:bg-gray-200 transition">
                    <i data-lucide="x" class="w-5 h-5"></i>
                </button>
                <span class="font-bold text-lg text-theme-text tracking-widest font-serif">請在此簽名</span>
                <button onclick="saveSignature()" class="px-5 py-2 bg-theme-text text-white rounded-full text-sm font-bold tracking-wider hover:bg-black transition shadow-lg">完成</button>
            </div>
            
            <div class="flex-1 bg-white rounded-3xl border border-gray-100 shadow-inner overflow-hidden relative touch-none ring-4 ring-theme-bg">
                <canvas id="signatureCanvas" class="w-full h-full"></canvas>
                <div class="absolute inset-0 pointer-events-none opacity-[0.03]" style="background-image: radial-gradient(#000 1px, transparent 1px); background-size: 20px 20px;"></div>
            </div>
            
            <div class="mt-6 flex justify-center pb-4 safe-pb sm:pb-0">
                 <button onclick="clearCanvas()" class="flex items-center gap-2 text-xs font-bold text-theme-sub hover:text-theme-rose transition px-4 py-2">
                    <i data-lucide="eraser" class="w-4 h-4"></i> 清除重寫
                </button>
            </div>
        </div>
    </div>

    <div id="toast" class="fixed top-8 left-1/2 -translate-x-1/2 glass-panel px-6 py-4 flex items-center gap-3 transform -translate-y-40 transition-all duration-500 z-[10000] rounded-full shadow-2xl min-w-[280px]">
        <div id="toastIconBg" class="w-6 h-6 rounded-full bg-green-500 flex items-center justify-center shrink-0">
            <i id="toastIcon" data-lucide="check" class="w-3.5 h-3.5 text-white stroke-[3]"></i>
        </div>
        <span class="text-sm font-bold text-theme-text tracking-wider" id="toastMsg">操作成功</span>
    </div>

    <script>
        lucide.createIcons();

        function router(page) {
            const home = document.getElementById('view-home');
            const form = document.getElementById('view-form');
            const navbar = document.getElementById('navbar');
            
            window.scrollTo({top: 0, behavior: 'smooth'});

            if (page === 'form') {
                home.style.display = 'none';
                form.classList.remove('hidden');
                navbar.classList.remove('opacity-0', 'pointer-events-none');
            } else {
                form.classList.add('hidden');
                home.style.display = 'flex';
                navbar.classList.add('opacity-0', 'pointer-events-none');
            }
        }

        let signaturePad = null;
        const modal = document.getElementById('signatureModal');
        const modalContent = document.getElementById('modalContent');
        const canvas = document.getElementById('signatureCanvas');

        function resizeCanvas() {
            const ratio = Math.max(window.devicePixelRatio || 1, 1);
            canvas.width = canvas.offsetWidth * ratio;
            canvas.height = canvas.offsetHeight * ratio;
            canvas.getContext("2d").scale(ratio, ratio);
            if(signaturePad) signaturePad.clear();
        }

        function openSignatureModal() {
            modal.classList.remove('hidden');
            setTimeout(() => {
                modal.classList.remove('opacity-0');
                modalContent.classList.remove('translate-y-full');
            }, 10);
            resizeCanvas();
            if (!signaturePad) {
                signaturePad = new SignaturePad(canvas, { 
                    minWidth: 1.5,
                    maxWidth: 3.5,
                    penColor: '#4A4238', 
                    velocityFilterWeight: 0.7 
                });
            }
        }

        function closeSignatureModal() {
            modalContent.classList.add('translate-y-full');
            modal.classList.add('opacity-0');
            setTimeout(() => {
                modal.classList.add('hidden');
            }, 500);
        }

        function clearCanvas() { if (signaturePad) signaturePad.clear(); }

        function saveSignature() {
            if (signaturePad.isEmpty()) { showToast('請先簽名', false); return; }
            const dataUrl = signaturePad.toDataURL();
            const preview = document.getElementById('sign-preview');
            const placeholder = document.getElementById('sign-placeholder');
            
            preview.src = dataUrl;
            preview.classList.remove('hidden');
            placeholder.classList.add('hidden');
            closeSignatureModal();
        }

        function submitForm(btn) {
            if(!document.getElementById('agreeCheck').checked) {
                showToast('請勾選同意服務條款', false);
                const checkArea = document.getElementById('agreeCheck').parentElement;
                checkArea.classList.add('animate-[pulse_0.2s_ease-in-out_3]');
                setTimeout(()=> checkArea.classList.remove('animate-[pulse_0.2s_ease-in-out_3]'), 600);
                return;
            }
            if(document.getElementById('sign-preview').classList.contains('hidden')) {
                 showToast('請完成簽名', false);
                 return;
            }

            const originalContent = btn.innerHTML;
            btn.innerHTML = `<i data-lucide="loader-2" class="animate-spin w-5 h-5"></i><span class="ml-2">處理中...</span>`;
            btn.disabled = true;
            btn.classList.add('opacity-80', 'cursor-not-allowed');
            lucide.createIcons();

            setTimeout(() => {
                showToast('契約傳送成功！');
                btn.innerHTML = `<i data-lucide="check-circle" class="w-5 h-5"></i><span class="ml-2">完成</span>`;
                btn.classList.replace('bg-gradient-lux', 'bg-green-500');
                
                setTimeout(() => {
                    router('home');
                    btn.innerHTML = originalContent;
                    btn.disabled = false;
                    btn.classList.remove('opacity-80', 'cursor-not-allowed', 'bg-green-500');
                    btn.classList.add('bg-gradient-lux');
                    
                    document.getElementById('petForm').reset();
                    document.getElementById('sign-preview').classList.add('hidden');
                    document.getElementById('sign-placeholder').classList.remove('hidden');
                    signaturePad.clear();
                }, 1500);
            }, 2000);
        }

        function showToast(msg, isSuccess = true) {
            const toast = document.getElementById('toast');
            const toastMsg = document.getElementById('toastMsg');
            const iconBg = document.getElementById('toastIconBg');
            const icon = document.getElementById('toastIcon');
            
            toastMsg.innerText = msg;
            
            if(isSuccess) {
                iconBg.className = "w-6 h-6 rounded-full bg-green-500 flex items-center justify-center shrink-0 shadow-sm";
                icon.setAttribute('data-lucide', 'check');
            } else {
                iconBg.className = "w-6 h-6 rounded-full bg-red-500 flex items-center justify-center shrink-0 shadow-sm";
                icon.setAttribute('data-lucide', 'alert-circle');
            }
            lucide.createIcons();
            
            toast.classList.remove('-translate-y-40');
            toast.classList.add('translate-y-0');
            
            setTimeout(() => {
                toast.classList.add('-translate-y-40');
                toast.classList.remove('translate-y-0');
            }, 3000);
        }

        window.addEventListener('resize', () => { if(!modal.classList.contains('hidden')) resizeCanvas(); });
    </script>
</body>
</html>
